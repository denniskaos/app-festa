<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rodízio · Definições</title>
  <link rel="stylesheet" href="/public/css/style.css" />
  <link rel="stylesheet" href="/public/app.css" />
</head>
<body>

<div class="toolbar">
  <h1>Rodízio</h1>
  <a class="btn btn-light" href="/definicoes" style="margin-left:auto">Voltar</a>
</div>

<section class="card" style="padding:16px">
  <form method="post" action="/definicoes/rodizio" class="form-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px">
    <label>Bloco por ciclo (€)
      <input type="number" step="0.01" min="0" name="bloco"
             value="<%= ((settings.rodizio_bloco_cents ?? 500000)/100).toFixed(2) %>" required>
    </label>

    <label>Casal onde começa a sequência
      <select name="inicio_casal_id" required>
        <option value="">— escolher —</option>
        <% casais.forEach(c => { %>
          <option value="<%= c.id %>" <%= (settings.rodizio_inicio_casal_id === c.id ? 'selected' : '') %>>
            <%= c.nome %>
          </option>
        <% }) %>
      </select>
    </label>

    <div style="align-self:end">
      <button class="btn">Guardar</button>
    </div>
  </form>
</section>

<section class="card" style="padding:16px; margin-top:12px">
  <h3 style="margin:0 0 10px">Resumo</h3>
  <div class="cards" style="margin-top:6px">
    <div class="card stat"><div class="stat-label">Total “em casa”</div><div class="stat-number">€ <%= (resumo.totalCasaCents/100).toFixed(2) %></div></div>
    <div class="card stat"><div class="stat-label">Tamanho do bloco</div><div class="stat-number">€ <%= (resumo.blocoCents/100).toFixed(2) %></div></div>
    <div class="card stat"><div class="stat-label">Blocos completos</div><div class="stat-number"><%= resumo.blocosCompletos %></div></div>
    <div class="card stat"><div class="stat-label">Blocos já aplicados</div><div class="stat-number"><%= resumo.blocksAplicados %></div></div>
    <div class="card stat"><div class="stat-label">Novos blocos por aplicar</div><div class="stat-number"><%= resumo.novos %></div></div>
    <div class="card stat"><div class="stat-label">Resto (não completo)</div><div class="stat-number">€ <%= (resumo.restoCents/100).toFixed(2) %></div></div>
  </div>

  <div style="margin-top:12px">
    <a class="btn btn-primary" href="/casais/rodizio">Ir para a distribuição</a>
  </div>
</section>

</body>
</html>
