<!-- views/definicoes.ejs -->
<div class="toolbar">
  <h1>Definições</h1>
  <div style="margin-left:auto;display:flex;gap:8px;flex-wrap:wrap">
    <a class="btn" href="/backup">Backup</a>
    <a class="btn" href="/definicoes/rodizio">Rodízio</a>
  </div>
</div>

<% if (err) { %>
  <div class="alert alert-error"><%= err %></div>
<% } %>
<% if (msg) { %>
  <div class="alert alert-success"><%= msg %></div>
<% } %>

<div class="grid" style="grid-template-columns: minmax(260px,1fr) minmax(260px,1fr); gap:12px;">
  <!-- Branding & UI -->
  <div class="card">
    <h3 style="margin-top:0">Branding & UI</h3>
    <form method="post" action="/definicoes" class="form-grid">
      <% (KEYS||[]).forEach(function(k){ %>
        <label><%= k.label %>
          <input type="<%= k.type %>" name="<%= k.key %>" value="<%= (map && map[k.key]) ? map[k.key] : '' %>" />
        </label>
      <% }) %>
      <div style="grid-column:1/-1;">
        <button class="btn btn-primary">Guardar</button>
      </div>
    </form>
  </div>

  <!-- Perfil -->
  <div class="card">
    <h3 style="margin-top:0">O meu perfil</h3>
    <form method="post" action="/definicoes/perfil" class="form-grid">
      <label>Nome
        <input name="name" value="<%= (me && me.name) || '' %>" />
      </label>
      <label>Email
        <input name="email" type="email" value="<%= (me && me.email) || '' %>" />
      </label>

      <div style="grid-column:1/-1" class="muted">Alterar palavra-passe (opcional)</div>
      <label>Password atual
        <input type="password" name="current_password" />
      </label>
      <label>Password nova
        <input type="password" name="new_password" />
      </label>
      <label>Confirmar password nova
        <input type="password" name="confirm_password" />
      </label>

      <div style="grid-column:1/-1;">
        <button class="btn btn-primary">Atualizar</button>
      </div>
    </form>
  </div>
</div>
