<div class="toolbar">
  <h1>Patrocinadores</h1>
  <a class="btn" style="margin-left:auto" href="/patrocinadores/new">Novo</a>
</div>

<div class="cards" style="margin-bottom:12px;">
  <div class="card stat">
    <div class="stat-label">Total Prometido</div>
    <div class="stat-number">€ <%= (totalProm/100).toFixed(2) %></div>
  </div>
  <div class="card stat">
    <div class="stat-label">Total Entregue</div>
    <div class="stat-number">€ <%= (totalEnt/100).toFixed(2) %></div>
  </div>
  <div class="card stat">
    <div class="stat-label">Em Falta</div>
    <div class="stat-number">€ <%= ((totalProm-totalEnt)/100).toFixed(2) %></div>
  </div>
</div>

<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>Nome</th>
        <th>Contacto</th>
        <th>Tipo</th>
        <th>Prometido</th>
        <th>Entregue</th>
        <th>Em Falta</th>
        <th style="width:200px">Ações</th>
      </tr>
    </thead>
    <tbody>
      <% if (!pats || !pats.length) { %>
        <tr><td colspan="7" class="muted">Sem patrocinadores.</td></tr>
      <% } %>
      <% (pats || []).forEach(p => { %>
        <tr>
          <td><%= p.name %></td>
          <td><%= p.contacto || '' %></td>
          <td><%= p.tipo || '' %></td>
          <td>€ <%= (p.valor_prometido_cents/100).toFixed(2) %></td>
          <td>€ <%= (p.valor_entregue_cents/100).toFixed(2) %></td>
          <td>€ <%= ((p.valor_prometido_cents - p.valor_entregue_cents)/100).toFixed(2) %></td>
          <td>
            <a class="btn btn-light" href="/patrocinadores/<%= p.id %>/edit">Editar</a>
            <form method="post" action="/patrocinadores/<%= p.id %>/delete" style="display:inline" onsubmit="return confirm('Apagar este patrocinador?')">
              <button class="btn btn-danger">Apagar</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
    <tfoot>
      <tr>
        <th colspan="3" style="text-align:right">Totais</th>
        <th>€ <%= (totalProm/100).toFixed(2) %></th>
        <th>€ <%= (totalEnt/100).toFixed(2) %></th>
        <th>€ <%= ((totalProm-totalEnt)/100).toFixed(2) %></th>
        <th></th>
      </tr>
    </tfoot>
  </table>
</div>
